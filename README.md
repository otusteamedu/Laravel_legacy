# Клиент-серверное возаимодейтсвие через Unix сокеты

Сначала запустить сервер командой
```
php src/server.php
```

Затем запустить клиент
```
php src/client.php
```

Сервер будет оправлять случайное сообщение на клиент раз в 2 секунды.
Клиент, получив сообщение от сервера отвечаем словом "Принято".
Сервер, дождавшись подтверждения от клиента, выводит "Сообщение ... принято клиентом" и через 2 секунды отправит следующее.

# Настройка окружения с помощью Docker

## Запуск
Для запуска необходимо выполнить две команды:
```
cp .env.example .env
docker-compose up
```
Открыть в браузере http://localhost:8080

## Настройка
В файле `.env.example` представлены настройки по умолчанию. После копирования этого файла в `.env` (с помощью команды `cp .env.example .env`), можно внести изменения в настройки путём редактирования `.env`.

По умолчанию на локальную (хост) машину пробрасываются следующие порты:
- 8080 для nginx
- 3307 для MySQL
- 6379 для Redis 

Проброс портов MySQL и Redis сделан для удобства разработки, чтобы можно было подключиться к с помощью привычных GUI клиентов.

Пользователь и пароль для MySQL по умолчанию user/test и root/test.
Redis без пароля.

В контейнере php-fpm установлен Xdebug, который подключается к локальной (хост) машине по порту 9001 (этот порт нужно указать в настройках PhpStorm).
Полные настройки Xdebug см. в файле `docker/php-fpm/99-dev.ini`.

## Используемые Docker образы
В корне проекта находится файл `docker-compose.yml` в котором описаны запускаемые сервисы:
- nginx
- php-fpm
- mysql
- redis

nginx, mysql и redis запускаются на основе официальных обрзов из Docker Hub.

php-fpm собиратся с помощью `Dockerfile` расположенного в `docker/php-fpm/Dockerfile`.
Особенность образа php-fpm в том, что он должен содержать в себе дополнительные расширения для работы с mysql и redis.
Также в образ php-fpm устанавилвается отладчик Xdebug. 

