# Д3 №4. Установка среды разработки. Выбор проекта

## 1. Установка среды разработки

В качестве среды разработки буду использовать набор вирутальных контейнеров Laradock.

С установкой никаких проблем не возникло. Единственное, что сделал это:

* поменял пути APP_CODE_PATH_HOST, DATA_PATH_HOST, некоторые пакеты php-fpm (например, добавил memcached) и пароль для рута MariaDB (хотя зачем)
* создал файлики для запуска и остановки контейнеров - start.sh "docker-compose up -d nginx php-fpm mariadb adminer" и stop.sh "docker-compose stop;". 
Пока буду использовать MariaDB, потом, если хватит времени поставлю Postgres и посмотрю как раз насколько слой данных не зависит от хранилища в таком, 
относительно простом случае - обе СУБД реляционные и похожи.
* создал файлик с хостом для nginx
* через управляющий контейнер `docker-compose exec --user=laradock workspace bash` создал болванку проекта `composer create-project laravel/laravel kinchik`
* создал через adminer новую базу данных и прописал их настройки в .env

Запуск прошел успешно. 

Дополнительно установил в PhpStorm плагин IDE Helper для Laravel.

[Screenshot-from-2019-09-09-14-00-55.png](https://github.com/otusteamedu/Laravel/tree/VYermakov/hw4/Screenshot-from-2019-09-09-14-00-55.png).

## 2. Выбор проекта

**Цели**. Мне хотелось бы в ходе реализации учебного проекта изучить нижеописанные вопросы даже безотносительно Lavarel. Вопросы:
* ORM на объектах с цепочками привязок друг к другу. Тут хотелось бы делать декомпозицию и спрашивать преподавателя о том, какой функционал куда положить, как разделить слой объектный и слой данных, чтобы именно в этом месте указывались на мои ошибки.
* Действия над объектами и цепочами привязок. Тут я прогоню сценарии CRUD. Самый больной вопрос, как показывает практика, - это удаление: какие объекты можно удалять, а какие только скрывать, какие данные копировать (например, в заказах), чтобы можно было удалять связанные фильмы.
* Разделение прав по действиям и ролям.
* IoC

Администрацией в лице Александра это все одобрено. Здесь пока не буду описывать формы и выставлять декомпозицию, это сделаю на этапах работы с БД и контроллерами.
    
### Сеть кинотеатров "Го в Кинчик"

Онлайн-сервис продажи билетов в оффлайн-сети кинотеатров. 

**Общее описание**

В сети кинотеатров... есть кинотеатры. В них идут... фильмы. В каждом кинотеатре есть залы, внутри которых есть разные типы мест (вип, стандарт, эконом). Администратор добавляет фильмы, которые планируются в прокат и формирует сеанс показа фильма. Пользователь может купить билет на незанятое место на какой-нибудь фильм в рамках сеанса, используя механизм корзины с подтверждением заказа.

**Роли участников**

В этом конкретном случае, роли пользователей можно расположить в порядке 
возрастания доступных функций. Т.е. пользователь каждой следующей роли может то, 
что может пользователь предыдущей роли и что-то еще. 
Располагаем роли в порядке возрастания прав:

1. Гость. Может:
    * смотреть информацию о всех фильмах: которые были / идут / будут в прокате
    * смотреть текущее расписание фильмов
    * может войти, зарегистрироваться
    * формировать корзину с билетами, но не отправлять заказ
    * смотреть кинотеатры, фильмы, связанное с кинотеатором расписание
    
2. Зарегистрированный пользователь. Может:
    * покупать билеты на сеансы.
    * оставлять отзыв о любом фильме, который был / идет в прокате
    
3. Администратор. Может:
    * управлять кинотеатрами
    * управлять залами
    * управлять типами тарифов
    * управлять расписанием сеансов
    * управлять ценами на сеансы
    * просматрировать заказы / корзины посетителей
    * просматрировать зарегистрированных посетитей, блокировать/удалять их
    * управлять отзывами


**Логические блоки проекта**

1. Пользователи.
    - Роли. Предустановленный список
    - Пользватели. Имя, Фамилия, E-mail, Телефон
    
2. Управление фильмами. Объекты:
    - режисеры: имя, фото, описание, дата рождения, снятые фильмы
    - актеры: имя, фото, описание, дата рождения, фильмы с участием.
    - жанры: название
    - фильмы: название, дата премьеры, режисеры, актеры, жанры, описание, постер, трейлер (ссылка на ютруп)
    - отзывы о фильмах: фильм, автор (пользователь системы), дата, оценка (1-5), отзыв в виде текста

3. Управление кинотеатрами. Объекты:
    - тарифы: название, коэффициент по умолчанию
    - места в зале: номер, тариф
    - залы: название, места. Залы будут прямоугольными MxN мест
    - кинотеатры: название, адрес, залы, гео-координаты

4. Управление сеансами
    - сеанс: зал (в кинотеатре), время, фильм
    - стоимость сеанса: стоимость, тариф

5. Управление продажами
    - билеты: сеанс, место, статус (создан, реализован), цена
    - позиции корзины (связь через посредника): товар (у нас только билет), стоимость
    - корзина: юзер (может быть только у зарегистрированного юзера), общая стоимость
    - заказ: корзина, имя, телефон

----

**Администрирование**

Страницы администрирования более менее ясны из описания.
Нестандартной страницей будет страница добавления сеансов, так как их добавление по-одному будет нереальным занятием. Поэтому надо будет разработать форму массового добавления проката, что с учетом крайней ограниченности фреймворков скорее всего превратится в мегаформу, в которой надо будет пользоваться базовым функционалом PHP в обход Laravel.

-------------------------------

**Публичная часть**

Так как при написании проекта я преследую цель, в первую очередь, 
решать бэкенд задачи, то на публичной части сайта будем экономить: 
никаких Angular, React. Страницы, доступные пользователю, будут 
иметь минимум красоты и удобств, т.е. фронтэнд будет максимально 
примитивным на старом JS, jQuery, немного AJAX - иначе эта часть 
будет отжирать большую часть времени.

Структура сайта:

1. Главная. Тут сразу выделю блоки для следующего ДЗ
    - Шапка: Лого, Меню, Войти, ЛК, Поиск
    - Скоро в прокате
    - Фильтр выбрать фильм: жанр, дата, кинотеатр
    - Популярные фильмы
    - О сети: текст, карта
    - Последние отзывы
    - Низ 

2. Фильмы в прокате
    1. Фильм в прокате (сеансы в разрезе кинотеатров, как на Я.Афише)

3. Кинотеатры сети
    1. Прокат в кинотеатре (сеансы в разрезе фильмов, как на Я.Афише)
    2. Заказ билета в кинотеатре

4. Личный кабинет
    1. Регистрация
    2. Вход
    3. Восстановление пароля
    4. Корзина
    5. Подтверждение заказа

-------------------------------
