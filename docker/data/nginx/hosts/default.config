server {
    server_name dev.localhost;
    listen 80;

    charset UTF-8;
    resolver 127.0.0.11 ipv6=off;
    index index.php, index.html, index.htm;
    set $root_path /var/www;
  	root $root_path;

	error_log /var/log/nginx/dev-error.log debug;
    access_log /var/log/nginx/dev-access.log;

    sendfile off;

    location / {
	    fastcgi_param QUERY_STRING    $query_string;
		fastcgi_param REQUEST_METHOD  $request_method;
		fastcgi_param CONTENT_TYPE    $content_type;
		fastcgi_param CONTENT_LENGTH  $content_length;

        location ~ [^/]\.ph(p\d*|tml)$ {
            try_files /does_not_exists @php;
        }
        proxy_read_timeout 600;
    }

    fastcgi_buffers 16 16k;
    fastcgi_buffer_size 32k;
    client_max_body_size 100m;

    location @php {
	    set $php_host php:9000;
        include fastcgi_params;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
	    fastcgi_param QUERY_STRING    $query_string;
	    fastcgi_param REQUEST_METHOD  $request_method;
	    fastcgi_param CONTENT_TYPE    $content_type;
	    fastcgi_param CONTENT_LENGTH  $content_length;
        fastcgi_pass $php_host;
        fastcgi_split_path_info ^((?U).+\.ph(?:p\d*|tml))(/?.+)$;
        fastcgi_read_timeout 600;
	    fastcgi_intercept_errors on;
        try_files $uri =404;
    }
}
